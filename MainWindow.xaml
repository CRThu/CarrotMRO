<Window x:Class="CarrotMRO.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CarrotMRO"
        xmlns:hc="https://handyorg.github.io/handycontrol"
        d:DataContext="{d:DesignInstance Type=local:MainViewModel}"
        mc:Ignorable="d"
        Title="MainWindow" Height="600" Width="1200">
    <Grid>
        <TabControl Margin="5">
            <TabItem Header="设置">
                <Grid>
                    <TextBlock Text="项目路径" Margin="10,24,0,0" HorizontalAlignment="Left" Width="109" Height="33" VerticalAlignment="Top"/>
                    <TextBox Text="{Binding ProjectPath}" Margin="118,24,0,0" Height="33" VerticalAlignment="Top" HorizontalAlignment="Left" Width="458"/>
                    <Button Content="导入" Command="{Binding LoadProjectCommand}" Width="80" Margin="595,25,0,0" VerticalAlignment="Top" HorizontalAlignment="Left" Height="30"/>
                </Grid>
            </TabItem>
            <TabItem Header="模板">
                <Grid>
                    <DataGrid ItemsSource="{Binding StandardItems}" AutoGenerateColumns="False" MinColumnWidth="120">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="项目" Binding="{Binding Name,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridTextColumn Header="单位" Binding="{Binding Unit,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                            <!--<DataGridTextColumn Header="数量" Binding="{Binding Num,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>-->
                            <DataGridTextColumn Header="单价" Binding="{Binding PerPrice,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                            <!--<DataGridTextColumn Header="总价" Binding="{Binding SumPrice,Mode=OneWay}"/>-->
                            <!--<DataGridTextColumn Header="备注" Binding="{Binding Description,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>-->
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>
            <TabItem Header="工程">
                <Grid Margin="5,5,5,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="2*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="类目" HorizontalAlignment="Left" Margin="34,28,0,0" TextWrapping="Wrap" VerticalAlignment="Top"/>
                    <hc:ComboBox Grid.Column="0" IsEditable="True" ItemsSource="{Binding Parts}" Text="{Binding SelectedPart,UpdateSourceTrigger=PropertyChanged}" Margin="93,21,0,0" HorizontalAlignment="Left" Width="261" Height="30" VerticalAlignment="Top"/>
                    <TextBlock Grid.Column="0" Text="项目" HorizontalAlignment="Left" Margin="34,79,0,0" TextWrapping="Wrap" VerticalAlignment="Top"/>
                    <hc:AutoCompleteTextBox Grid.Column="0" ItemsSource="{Binding CustomItemNames}" Text="{Binding SelectedCustomItemName}" Width="258" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="93,72,0,0"/>
                    <TextBlock Grid.Column="0" Text="标准项目" HorizontalAlignment="Left" Margin="34,131,0,0" TextWrapping="Wrap" VerticalAlignment="Top"/>
                    <hc:AutoCompleteTextBox Grid.Column="0" ItemsSource="{Binding StandardItems}" Text="{Binding SelectedStandardItemName}" DisplayMemberPath="Name" Width="258" VerticalAlignment="Top" HorizontalAlignment="Left" Margin="96,124,0,0"/>
                    <TextBlock Grid.Column="0" Text="数量" HorizontalAlignment="Left" Margin="34,178,0,0" TextWrapping="Wrap" VerticalAlignment="Top"/>
                    <TextBox Text="{Binding ItemNum}" Margin="96,170,0,0" Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Width="258"/>
                    <TextBlock Grid.Column="0" Text="备注" HorizontalAlignment="Left" Margin="34,220,0,0" TextWrapping="Wrap" VerticalAlignment="Top"/>
                    <TextBox Text="{Binding ItemDesc}" Margin="96,220,0,0" Height="30" VerticalAlignment="Top" HorizontalAlignment="Left" Width="258"/>
                    <Button Content="添加条目" Command="{Binding AddItemCommand}" Height="41" Width="80" Margin="305,0,0,10" VerticalAlignment="Bottom" HorizontalAlignment="Left"/>

                    <DataGrid Grid.Column="1" ItemsSource="{Binding UserItems}" SelectedItem="{Binding SelectedUserItem}" Margin="0,0,0,90" AutoGenerateColumns="False" MinColumnWidth="80">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="类目" Binding="{Binding Part,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridTextColumn Header="自定项目" Binding="{Binding CustomName,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridTextColumn Header="标准项目" Binding="{Binding Name,Mode=OneWay}"/>
                            <DataGridTextColumn Header="单位" Binding="{Binding Unit,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridTextColumn Header="数量" Binding="{Binding Num,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                            <DataGridTextColumn Header="单价" Binding="{Binding PerPrice,Mode=OneWay}"/>
                            <DataGridTextColumn Header="总价" Binding="{Binding SumPrice,Mode=OneWay}"/>
                            <DataGridTextColumn Header="备注" Binding="{Binding Description,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Bottom" Height="55">
                        <Button Content="验证项目" Command="{Binding ValidateUserItemsCommand}" Margin="20,0,0,0" Width="100"/>
                        <Button Content="删除所选项" Command="{Binding RemoveSelectedUserItemCommand}" Margin="20,0,0,0" Width="100"/>
                        <Button Content="删除所有" Command="{Binding ClearAllUserItemsCommand}" Margin="20,0,0,0" Width="100"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            <TabItem Header="生成">

            </TabItem>
            <TabItem Header="版本">
                <TextBlock Text="{Binding VersionText}" FontSize="18" Margin="5,5,5,5" VerticalAlignment="Top" HorizontalAlignment="Left"/>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
